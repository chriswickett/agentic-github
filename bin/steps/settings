#!/usr/bin/env bash
set -euo pipefail
source "$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/../lib/guards.sh"

require_vars FULL_REPO

echo ""
info "Configuring repo settings..."

gh api -X PATCH "/repos/$FULL_REPO" \
  -F allow_auto_merge=false \
  -F allow_squash_merge=true \
  -F delete_branch_on_merge=true \
  > /dev/null \
  || err "Failed to update repo settings â€” check permissions"

ok "Auto-merge disabled, squash merge enabled, delete branch on merge enabled"
